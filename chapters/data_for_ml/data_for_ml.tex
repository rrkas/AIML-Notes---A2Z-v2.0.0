\chapter{Data for ML}

\begin{enumerate}
    \item The table of examples ${x_1, ..., x_N}$ is often concatenated, and written as $X \in R^{N \times D}$
    \item We will discuss finding good representations in two ways:
    \begin{enumerate}
        \item Finding lower-dimensional approximations of the original feature vector
        \item Using nonlinear higher-dimensional combinations of the original feature vector
    \end{enumerate}
\end{enumerate}


\section{Types of Datasets}\label{Types of Datasets}

\subsection{Training Data/ Train Set}\label{Training Data/ Train Set}
\begin{enumerate}
    \item Actual data that is used to train the model
\end{enumerate}

\subsection{Testing Data/ Test Set}\label{Testing Data/ Test Set}
\begin{enumerate}
    \item Data used to test accuracy of model
    \item Maybe or may not be subset of train set
    \item Unseen data for model
\end{enumerate}

\subsection{Validation (val) Set/ Development (dev) Set}\label{Validation (val) Set/ Development (dev) Set}
\begin{enumerate}
    \item Data used for cross-validation
    \item Subset of train set
    \item Unseen data for model (atleast not directly)
\end{enumerate}

\vspace{0.2cm}


\textbf{Note:}
\begin{enumerate}
    \item Sometimes test set and val set are used interchangeably
\end{enumerate}

\section{Distribution Shift \cite{dnn-1,mit-imbalance-outliers-shift}}

Distribution shift is a challenging problem that occurs when the joint distribution of inputs and outputs differs between training and test stages.

\begin{table}[H]
    \begin{minipage}{0.45\textwidth}
        \begin{figure}[H]
            \centering
            \includegraphics[width=7.5cm,height=4cm]{Pictures/ml-data/ml-datasets-type.jpg}
            \caption{Datasets: Types}
        \end{figure}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \begin{figure}[H]
            \centering
            \includegraphics[width=7.5cm,height=4cm]{Pictures/ml-data/ml-data-distribution-shift.jpg}
            \caption{Distribution Shift}
        \end{figure}
    \end{minipage}
\end{table}

\subsection{Covariate shift / data shift}\label{Covariate shift / data shift}
Covariate shift occurs when $p(x)$ changes between train and test, but $p(y|x)$ does not. In other words, the distribution of inputs changes between train and test, but the relationship between inputs and outputs does not change.

\vspace{0.2cm}
\textbf{Examples of covariate shift:}
\begin{enumerate}
    \item Self-driving car trained on the sunny streets of San Francisco and deployed in the snowy streets of Boston
    \item Speech recognition model trained on native English speakers and then deployed for all English speakers
    \item Diabetes prediction model trained on hospital data from Boston and deployed in India
\end{enumerate}

\begin{table}[H]
    \begin{minipage}{0.45\textwidth}
        \begin{figure}[H]
            \centering
            \includegraphics[width=7.5cm,height=4cm]{Pictures/ml-data/ml-data-covariate-shift.jpg}
            \caption{Distribution Shift: Covariate Shift/ Data Shift}
        \end{figure}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \begin{figure}[H]
            \centering
            \includegraphics[width=7.5cm,height=4cm]{Pictures/ml-data/ml-data-concept-shift.jpg}
            \caption{Distribution Shift: Concept Shift}
        \end{figure}
    \end{minipage}
\end{table}

\subsection{Concept shift}\label{Concept shift}
Concept shift occurs when $p(y|x)$ changes between train and test, but $p(x)$ does not. In other words, the input distribution does not change, but the relationship between inputs and outputs does. This can be one of the most difficult types of distribution shift to detect and correct.

\vspace{0.2cm}
\textbf{Examples:}
\begin{enumerate}
    \item Predicting a stock price based on company fundamentals, trained on data from 1975 and deployed in 2023.
    \item Making purchase recommendations based on web browsing behavior, trained on pre-pandemic data and deployed in March 2020.
\end{enumerate}

\subsubsection{Prior probability shift / label shift}\label{Prior probability shift / label shift}
Prior probability shift appears only in $y \to x$ problems (when we believe $y$ causes $x$). It occurs when $p(y)$ changes between train and test, but $p(x|y)$ does not. You can think of it as the converse of covariate shift.

\vspace{0.2cm}
\textbf{Examples:}
\begin{enumerate}
    \item If the model is trained on a balanced dataset of 50\% spam and 50\% non-spam emails, and then itâ€™s deployed in a real-world setting where 90\% of emails are spam, that is an example of prior probability shift.
\end{enumerate}

SEE: \fullref{Covariate Shift (Data Shift) VS Concept Shift VS Prior Probability Shift (Label Shift)}


















